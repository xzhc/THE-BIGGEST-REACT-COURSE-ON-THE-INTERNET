# ä»£ç å®¡æŸ¥æ¨¡å¼

> ä½¿ç”¨åœºæ™¯ï¼šå®Œæˆä»£ç åï¼Œè¯· AI è¿›è¡Œä¸“ä¸šçš„ä»£ç å®¡æŸ¥

## è§¦å‘æŒ‡ä»¤

```
è¯·å¸®æˆ‘å®¡æŸ¥è¿™æ®µä»£ç ï¼š[ç²˜è´´ä»£ç æˆ–é€‰ä¸­ä»£ç ]
```

æˆ–è€…

```
@code-review
```

---

## AI å®¡æŸ¥æµç¨‹

### 1. å…ˆè‚¯å®šä¼˜ç‚¹ âœ…
æŒ‡å‡ºä»£ç ä¸­åšå¾—å¥½çš„åœ°æ–¹ï¼š
- æ­£ç¡®çš„æ¨¡å¼ä½¿ç”¨
- è‰¯å¥½çš„ä»£ç é£æ ¼
- åˆç†çš„æ¶æ„è®¾è®¡

### 2. å‘ç°é—®é¢˜ï¼ˆæŒ‰ä¸¥é‡ç¨‹åº¦ï¼‰

#### ğŸ”´ ä¸¥é‡é—®é¢˜ï¼ˆå¿…é¡»ä¿®å¤ï¼‰
- ä¼šå¯¼è‡´ bug çš„ä»£ç 
- æ€§èƒ½é—®é¢˜
- å®‰å…¨éšæ‚£
- å†…å­˜æ³„æ¼é£é™©

**ç¤ºä¾‹ï¼š**
```typescript
// ğŸ”´ é—®é¢˜ï¼šuseEffect ç¼ºå°‘ä¾èµ–é¡¹ï¼Œä¼šå¯¼è‡´é—­åŒ…é™·é˜±
useEffect(() => {
  console.log(count)  // count å˜åŒ–ä¸ä¼šåæ˜ 
}, [])  // âŒ ä¾èµ–æ•°ç»„ä¸ºç©º

// âœ… ä¿®å¤
useEffect(() => {
  console.log(count)
}, [count])  // âœ… æ·»åŠ  count ä¾èµ–
```

#### ğŸŸ¡ æ”¹è¿›å»ºè®®ï¼ˆåº”è¯¥ä¼˜åŒ–ï¼‰
- ä»£ç å¯è¯»æ€§
- å¯ç»´æŠ¤æ€§
- å¯å¤ç”¨æ€§
- TypeScript ç±»å‹å®Œå–„

**ç¤ºä¾‹ï¼š**
```typescript
// ğŸŸ¡ å»ºè®®ï¼šä½¿ç”¨æ›´è¯­ä¹‰åŒ–çš„å‘½å
const handleClick = () => { /* ... */ }  // âœ… æ¸…æ™°
const click = () => { /* ... */ }        // âŒ ä¸å¤Ÿæ˜ç¡®

// ğŸŸ¡ å»ºè®®ï¼šæå–é­”æ³•æ•°å­—ä¸ºå¸¸é‡
const MAX_RETRY_COUNT = 3  // âœ…
const count = 3            // âŒ é­”æ³•æ•°å­—
```

#### ğŸŸ¢ å­¦ä¹ æ–¹å‘ï¼ˆå¯é€‰ä¼˜åŒ–ï¼‰
- æ›´é«˜çº§çš„æ¨¡å¼
- æ€§èƒ½å¾®ä¼˜åŒ–
- ç°ä»£è¯­æ³•
- å·¥å…·ä½¿ç”¨

**ç¤ºä¾‹ï¼š**
```typescript
// ğŸŸ¢ å¯é€‰ï¼šä½¿ç”¨å¯é€‰é“¾ç®€åŒ–ä»£ç 
const name = user && user.profile && user.profile.name  // âŒ ç¹ç
const name = user?.profile?.name  // âœ… æ›´ç®€æ´
```

### 3. æä¾›æ”¹è¿›åçš„å®Œæ•´ä»£ç 

```typescript
// æ”¹è¿›åçš„ä»£ç ï¼ˆé™„å¸¦å®Œæ•´æ³¨é‡Šï¼‰
```

### 4. è§£é‡Šæ¯ä¸ªä¿®æ”¹çš„åŸå› 

**ä¸ºä»€ä¹ˆè¿™æ ·æ”¹ï¼š**
1. åŸå›  1...
2. åŸå›  2...

### 5. æ‰©å±•çŸ¥è¯†ç‚¹

**ç›¸å…³æœ€ä½³å®è·µï¼š**
- é“¾æ¥åˆ°å®˜æ–¹æ–‡æ¡£
- å¸¸è§æ¨¡å¼
- å¤§å‚å®è·µ

### 6. æå‡ºæ€è€ƒé¢˜

**æ€è€ƒï¼š**
- å¦‚æœéœ€æ±‚å˜åŒ–ä¸º XXXï¼Œä»£ç åº”è¯¥å¦‚ä½•è°ƒæ•´ï¼Ÿ
- è¿™ä¸ªç»„ä»¶è¿˜æœ‰å“ªäº›å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼Ÿ

---

## å®¡æŸ¥æ£€æŸ¥æ¸…å•

### React ç»„ä»¶å®¡æŸ¥
- [ ] **çŠ¶æ€ç®¡ç†**
  - çŠ¶æ€æ˜¯å¦å¿…è¦ï¼Ÿ
  - çŠ¶æ€ä½ç½®æ˜¯å¦åˆç†ï¼Ÿ
  - æ˜¯å¦æœ‰ä¸å¿…è¦çš„é‡æ¸²æŸ“ï¼Ÿ
  
- [ ] **å‰¯ä½œç”¨å¤„ç†**
  - useEffect ä¾èµ–æ˜¯å¦æ­£ç¡®ï¼Ÿ
  - æ˜¯å¦æœ‰æ¸…ç†é€»è¾‘ï¼Ÿ
  - æ˜¯å¦ä¼šå¯¼è‡´æ— é™å¾ªç¯ï¼Ÿ
  
- [ ] **æ€§èƒ½ä¼˜åŒ–**
  - æ˜¯å¦éœ€è¦ useMemo/useCallbackï¼Ÿ
  - åˆ—è¡¨æ˜¯å¦æœ‰ keyï¼Ÿ
  - æ˜¯å¦æœ‰ä¸å¿…è¦çš„è®¡ç®—ï¼Ÿ
  
- [ ] **é”™è¯¯å¤„ç†**
  - æ˜¯å¦å¤„ç†äº†å¼‚æ­¥é”™è¯¯ï¼Ÿ
  - è¾¹ç•Œæƒ…å†µæ˜¯å¦è€ƒè™‘ï¼Ÿ
  - æ˜¯å¦æœ‰é”™è¯¯è¾¹ç•Œï¼Ÿ

### TypeScript å®¡æŸ¥
- [ ] **ç±»å‹å®šä¹‰**
  - æ˜¯å¦é¿å…äº† anyï¼Ÿ
  - æ˜¯å¦å……åˆ†åˆ©ç”¨ç±»å‹æ¨å¯¼ï¼Ÿ
  - æ˜¯å¦å®šä¹‰äº†å¿…è¦çš„æ¥å£ï¼Ÿ
  
- [ ] **ç±»å‹å®‰å…¨**
  - æ˜¯å¦æœ‰ç±»å‹æ–­è¨€ï¼Ÿæ˜¯å¦åˆç†ï¼Ÿ
  - æ˜¯å¦å¤„ç†äº† null/undefinedï¼Ÿ

### ä»£ç è´¨é‡
- [ ] **å‘½å**
  - å˜é‡åæ˜¯å¦è¯­ä¹‰åŒ–ï¼Ÿ
  - å‡½æ•°åæ˜¯å¦æè¿°è¡Œä¸ºï¼Ÿ
  - ç»„ä»¶åæ˜¯å¦æ¸…æ™°ï¼Ÿ
  
- [ ] **å¯è¯»æ€§**
  - æ˜¯å¦æœ‰å……åˆ†æ³¨é‡Šï¼Ÿ
  - é€»è¾‘æ˜¯å¦æ¸…æ™°ï¼Ÿ
  - æ˜¯å¦æœ‰è¿‡åº¦åµŒå¥—ï¼Ÿ
  
- [ ] **å¯ç»´æŠ¤æ€§**
  - æ˜¯å¦æœ‰é‡å¤ä»£ç ï¼Ÿ
  - æ˜¯å¦å¯ä»¥æå–ä¸ºå¯å¤ç”¨é€»è¾‘ï¼Ÿ
  - æ˜¯å¦ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ï¼Ÿ

### å®‰å…¨æ€§
- [ ] XSS é˜²æŠ¤
- [ ] è¾“å…¥éªŒè¯
- [ ] æ•æ„Ÿä¿¡æ¯å¤„ç†

---

## ç¤ºä¾‹å¯¹è¯

**å­¦ç”Ÿï¼š**
```typescript
è¯·å®¡æŸ¥è¿™æ®µä»£ç ï¼š

function UserProfile({ userId }) {
  const [user, setUser] = useState(null)
  
  useEffect(() => {
    fetch(`/api/users/${userId}`)
      .then(res => res.json())
      .then(data => setUser(data))
  }, [])
  
  return <div>{user.name}</div>
}
```

**AI Mentorï¼š**

### âœ… åšå¾—å¥½çš„åœ°æ–¹
- ä½¿ç”¨äº† useState ç®¡ç†ç”¨æˆ·æ•°æ®
- ä½¿ç”¨äº† useEffect å¤„ç†å‰¯ä½œç”¨

### ğŸ”´ ä¸¥é‡é—®é¢˜

**é—®é¢˜ 1ï¼šuseEffect ä¾èµ–é¡¹ç¼ºå¤±**
```typescript
useEffect(() => {
  // ...
}, [])  // âŒ ç¼ºå°‘ userId ä¾èµ–
```
**å½±å“ï¼š** å½“ userId å˜åŒ–æ—¶ï¼Œä¸ä¼šé‡æ–°è·å–æ•°æ®

**é—®é¢˜ 2ï¼šå¯èƒ½çš„ç©ºæŒ‡é’ˆé”™è¯¯**
```typescript
return <div>{user.name}</div>  // âŒ user å¯èƒ½ä¸º null
```
**å½±å“ï¼š** åˆå§‹æ¸²æŸ“æ—¶ä¼šæŠ¥é”™

**é—®é¢˜ 3ï¼šç¼ºå°‘é”™è¯¯å¤„ç†**
- ç½‘ç»œè¯·æ±‚å¤±è´¥æ—¶æ²¡æœ‰å¤„ç†
- æ²¡æœ‰ loading çŠ¶æ€

**é—®é¢˜ 4ï¼šå†…å­˜æ³„æ¼é£é™©**
- ç»„ä»¶å¸è½½å setUser å¯èƒ½ä»è¢«è°ƒç”¨

### ğŸŸ¡ æ”¹è¿›å»ºè®®

**å»ºè®® 1ï¼šæ·»åŠ  TypeScript ç±»å‹**
```typescript
interface User {
  name: string
  // ... å…¶ä»–å­—æ®µ
}

interface Props {
  userId: string
}
```

**å»ºè®® 2ï¼šä½¿ç”¨ç°ä»£ API**
- ä½¿ç”¨ async/await æ›¿ä»£ .then()
- è€ƒè™‘ä½¿ç”¨ TanStack Query ç­‰åº“

### âœ… æ”¹è¿›åçš„ä»£ç 

```typescript
interface User {
  name: string
  email: string
}

interface Props {
  userId: string
}

function UserProfile({ userId }: Props) {
  const [user, setUser] = useState<User | null>(null)
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState<Error | null>(null)
  
  useEffect(() => {
    // ç”¨äºå–æ¶ˆè¯·æ±‚çš„æ ‡å¿—
    let cancelled = false
    
    const fetchUser = async () => {
      try {
        setLoading(true)
        setError(null)
        
        const res = await fetch(`/api/users/${userId}`)
        if (!res.ok) {
          throw new Error('Failed to fetch user')
        }
        
        const data = await res.json()
        
        // åªæœ‰åœ¨ç»„ä»¶æœªå¸è½½æ—¶æ‰æ›´æ–°çŠ¶æ€
        if (!cancelled) {
          setUser(data)
        }
      } catch (err) {
        if (!cancelled) {
          setError(err as Error)
        }
      } finally {
        if (!cancelled) {
          setLoading(false)
        }
      }
    }
    
    fetchUser()
    
    // æ¸…ç†å‡½æ•°ï¼šé˜²æ­¢å†…å­˜æ³„æ¼
    return () => {
      cancelled = true
    }
  }, [userId])  // âœ… æ·»åŠ  userId ä¾èµ–
  
  // åŠ è½½çŠ¶æ€
  if (loading) {
    return <div>Loading...</div>
  }
  
  // é”™è¯¯çŠ¶æ€
  if (error) {
    return <div>Error: {error.message}</div>
  }
  
  // ç©ºçŠ¶æ€
  if (!user) {
    return <div>User not found</div>
  }
  
  // æ­£å¸¸æ¸²æŸ“
  return (
    <div>
      <h2>{user.name}</h2>
      <p>{user.email}</p>
    </div>
  )
}
```

### ğŸ“š ä¸ºä»€ä¹ˆè¿™æ ·æ”¹

1. **æ·»åŠ  userId åˆ°ä¾èµ–æ•°ç»„**
   - userId å˜åŒ–æ—¶é‡æ–°è·å–æ•°æ®
   - éµå¾ª React Hooks è§„åˆ™

2. **æ·»åŠ  loading å’Œ error çŠ¶æ€**
   - æå‡ç”¨æˆ·ä½“éªŒ
   - ç”Ÿäº§çº§åº”ç”¨çš„æ ‡å‡†åšæ³•

3. **ä½¿ç”¨ cancelled æ ‡å¿—**
   - é˜²æ­¢ç»„ä»¶å¸è½½åè°ƒç”¨ setState
   - é¿å…å†…å­˜æ³„æ¼å’Œè­¦å‘Š

4. **å®Œå–„çš„é”™è¯¯å¤„ç†**
   - æ•è·ç½‘ç»œé”™è¯¯
   - æ£€æŸ¥å“åº”çŠ¶æ€
   - æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯ä¿¡æ¯

5. **TypeScript ç±»å‹**
   - ç±»å‹å®‰å…¨
   - æ›´å¥½çš„ IDE æç¤º

### ğŸš€ è¿›é˜¶æ–¹å‘

**æ–¹æ¡ˆ 1ï¼šä½¿ç”¨è‡ªå®šä¹‰ Hook**
```typescript
function useFetchUser(userId: string) {
  // å°è£…é€»è¾‘ï¼Œæé«˜å¤ç”¨æ€§
}
```

**æ–¹æ¡ˆ 2ï¼šä½¿ç”¨ TanStack Query**
```typescript
const { data, isLoading, error } = useQuery({
  queryKey: ['user', userId],
  queryFn: () => fetchUser(userId)
})
// è‡ªåŠ¨å¤„ç†ç¼“å­˜ã€é‡è¯•ã€loading ç­‰
```

### ğŸ’­ æ€è€ƒé¢˜

1. å¦‚æœéœ€è¦æ·»åŠ "é‡è¯•"åŠŸèƒ½ï¼Œä½ ä¼šå¦‚ä½•å®ç°ï¼Ÿ
2. è¿™ä¸ªç»„ä»¶å¦‚ä½•æµ‹è¯•ï¼Ÿéœ€è¦ mock å“ªäº›éƒ¨åˆ†ï¼Ÿ
3. å¦‚æœ API å¾ˆæ…¢ï¼Œå¦‚ä½•ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Ÿï¼ˆæç¤ºï¼šéª¨æ¶å±ã€ä¹è§‚æ›´æ–°ï¼‰

---

**ä¸‹æ¬¡å®¡æŸ¥ä»£ç æ—¶ï¼Œå¯ä»¥ä¸»åŠ¨æ€è€ƒè¿™äº›æ£€æŸ¥ç‚¹ï¼**

